[3J[H[2J‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/config
customresourcedefinition.apiextensions.k8s.io/apiresourceimports.apiresource.kcp.dev created
customresourcedefinition.apiextensions.k8s.io/negotiatedapiresources.apiresource.kcp.dev created
customresourcedefinition.apiextensions.k8s.io/clusters.cluster.example.dev created
‚ò∏Ô∏è $ kubectl api-resources | grep deployments
‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/contrib/demo/clusters/kind/us-east1.yaml
cluster.cluster.example.dev/us-east1 created
‚ò∏Ô∏è $ kubectl get clusters -o wide
NAME       LOCATION   READY   SYNCED API RESOURCES
us-east1   us-east1           
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    True         
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps             apps/v1       deployments                
‚ò∏Ô∏è $ kubectl patch negotiatedapiresources deployments.v1.apps --type="merge" -p '{"spec":{"publish":true}}'
negotiatedapiresource.apiresource.kcp.dev/deployments.v1.apps patched
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps   true      apps/v1       deployments    False       False
‚ò∏Ô∏è $ kubectl get crds -o custom-columns=NAME:.metadata.name | grep deployments
deployments.apps
‚ò∏Ô∏è $ kubectl api-resources | grep deployments
deployments                   deploy       apps/v1                                true         Deployment
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps   true      apps/v1       deployments    True        False
‚ò∏Ô∏è $ kubectl get crds deployments.apps -o yaml | grep ephemeralContainers
                      ephemeralContainers:
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    True         True
‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/contrib/demo/clusters/kind/us-west1.yaml
cluster.cluster.example.dev/us-west1 created
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    True         True
deployments.us-west1.v1.apps   us-west1   UpdateUnpublished        apps/v1       deployments    True         True
‚ò∏Ô∏è $ kubectl get apiresourceimports deployments.us-west1.v1.apps -o=go-template='{{ range .status.conditions }}{{ if eq .type "Compatible" }}{{ .message }}{{ end }}{{ end }}'
<no value>
‚ò∏Ô∏è $ kubectl patch apiresourceimports deployments.us-west1.v1.apps --type="merge" -p '{"spec":{"schemaUpdateStrategy":"UpdatePublished"}}'
apiresourceimport.apiresource.kcp.dev/deployments.us-west1.v1.apps patched
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    True         True
deployments.us-west1.v1.apps   us-west1   UpdatePublished          apps/v1       deployments    True         True
‚ò∏Ô∏è $ kubectl get negotiatedapiresource deployments.v1.apps -o yaml | grep ephemeralContainers
                  ephemeralContainers:
‚ò∏Ô∏è $ kubectl get crds deployments.apps -o yaml | grep ephemeralContainers
                      ephemeralContainers:
‚ò∏Ô∏è $ kubectl delete clusters us-west1
cluster.cluster.example.dev "us-west1" deleted
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    True         True
‚ò∏Ô∏è $ kubectl get negotiatedapiresource deployments.v1.apps -o yaml | grep ephemeralContainers
                  ephemeralContainers:
‚ò∏Ô∏è $ kubectl get crds deployments.apps -o yaml | grep ephemeralContainers
                      ephemeralContainers:
‚ò∏Ô∏è $ kubectl delete clusters us-east1
cluster.cluster.example.dev "us-east1" deleted
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
No resources found
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
No resources found
‚ò∏Ô∏è $ kubectl api-resources | grep deployments
[3J[H[2J‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/contrib/crds/apps/apps_deployments.yaml
customresourcedefinition.apiextensions.k8s.io/deployments.apps created
‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/contrib/demo/clusters/kind/us-west1.yaml
cluster.cluster.example.dev/us-west1 created
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-west1.v1.apps   us-west1   UpdateUnpublished        apps/v1       deployments    False        True
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps   true      apps/v1       deployments    True        True
‚ò∏Ô∏è $ kubectl patch apiresourceimports deployments.us-west1.v1.apps --type="merge" -p '{"spec":{"schemaUpdateStrategy":"UpdatePublished"}}'
apiresourceimport.apiresource.kcp.dev/deployments.us-west1.v1.apps patched
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-west1.v1.apps   us-west1   UpdatePublished          apps/v1       deployments    False        True
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps   true      apps/v1       deployments    True        True
‚ò∏Ô∏è $ kubectl apply -f /home/dfestal/go/src/github.com/kcp-dev/kcp/contrib/demo/clusters/kind/us-east1.yaml
cluster.cluster.example.dev/us-east1 created
‚ò∏Ô∏è $ kubectl get apiresourceimports -o wide
NAME                           LOCATION   SCHEMA UPDATE STRATEGY   API VERSION   API RESOURCE   COMPATIBLE   AVAILABLE
deployments.us-east1.v1.apps   us-east1   UpdateUnpublished        apps/v1       deployments    False        
deployments.us-west1.v1.apps   us-west1   UpdatePublished          apps/v1       deployments    False        True
‚ò∏Ô∏è $ kubectl get negotiatedapiresources -o wide
NAME                  PUBLISH   API VERSION   API RESOURCE   PUBLISHED   ENFORCED
deployments.v1.apps   true      apps/v1       deployments    True        True
