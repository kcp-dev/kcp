
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Deploy kcp with self-signed certificates across multiple regions.
">
      
      
      
        <link rel="canonical" href="https://docs.kcp.io/kcp/v0.30/setup/production/kcp-zheng/">
      
      
        <link rel="prev" href="../kcp-vespucci/">
      
      
        <link rel="next" href="../overview/">
      
      
      <link rel="icon" href="../../../favicons/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>kcp-zheng: Multi-Region Self-Signed Certificate Deployment - docs.kcp.io</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/crd.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
     
<style>
  #version-banner {
    display: none;
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    width: 100%;
    background-color: #00bcd4;
    color: white;
    padding: 8px 16px;
    text-align: center;
    font-size: 14px;
    line-height: 1.5;
    z-index: 10000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  #version-banner a {
    color: white;
    text-decoration: underline;
    margin-left: 8px;
  }

  #version-banner a:hover {
    text-decoration: none;
  }

  .md-header {
    transition: top 0.2s ease;
  }
</style>

<script>
  (function () {
    "use strict";

    const CONFIG = {
      UNRELEASED_VERSION: "main",
      RETRY_DELAY: 500,
      HEADER_ADJUST_DELAY: 100,
    };

    function getCurrentVersion() {
      const path = window.location.pathname;
      const versionMatch = path.match(/\/(main|v\d+\.\d+[^\/]*)/);
      return versionMatch ? versionMatch[1] : null;
    }

    function getAvailableVersions() {
      const versionList = document.querySelector("ul.md-version__list");
      if (!versionList) return [];

      const links = Array.from(
        versionList.querySelectorAll("a.md-version__link")
      );

      return links
        .map((link) => {
          const href = link.href || link.getAttribute("href");
          const match = href.match(/\/(v\d+\.\d+[^\/]*)\//);
          return match ? match[1] : null;
        })
        .filter((v) => v && /^v\d+\.\d+/.test(v))
        .filter((v, i, arr) => arr.indexOf(v) === i);
    }

    function getLatestVersionPath() {
      const versions = getAvailableVersions();

      const latestVersion = versions[0];
      const currentPath = window.location.pathname;

      return (
        currentPath.replace(/\/main(\/|$)/, `/${latestVersion}$1`) ||
        `/${latestVersion}/`
      );
    }

    function createBanner() {
      const banner = document.createElement("div");
      banner.id = "version-banner";
      banner.innerHTML = `
    <strong>You are viewing the docs for an unreleased version.</strong>
    <a href="#" id="latest-version-link">Click here to go to the latest stable version.</a>
  `;

      document.body.insertBefore(banner, document.body.firstChild);
      banner.style.display = "block";

      return banner;
    }

    function updateBannerLink(banner) {
      const link = banner.querySelector("#latest-version-link");
      if (!link) return;

      const latestPath = getLatestVersionPath();
      link.href = latestPath;
    }

    function adjustHeader(banner) {
      setTimeout(() => {
        const header = document.querySelector(".md-header");
        if (!header) return;

        const bannerHeight = banner.offsetHeight;
        const headerHeight = header.offsetHeight;

        header.style.top = `${bannerHeight}px`;
        document.documentElement.style.setProperty(
          "--md-header-height",
          `${bannerHeight + headerHeight}px`
        );
        document.documentElement.style.setProperty(
          "--md-scroll-margin",
          `${bannerHeight + headerHeight}px`
        );
      }, CONFIG.HEADER_ADJUST_DELAY);
    }

    function init() {
      const currentVersion = getCurrentVersion();

      if (currentVersion !== CONFIG.UNRELEASED_VERSION) {
        return;
      }

      const banner = createBanner();
      updateBannerLink(banner);

      setTimeout(() => updateBannerLink(banner), CONFIG.RETRY_DELAY);

      adjustHeader(banner);
    }

    function waitForDOM() {
      if (
        document.readyState === "complete" ||
        document.readyState === "interactive"
      ) {
        console.log("DOM is ready, initializing...");
        init();
        return;
      }

      console.log("DOM not ready yet, checking again...");
      setTimeout(waitForDOM, 1000);
    }

    waitForDOM();
  })();
</script>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kcp-zheng-multi-region-self-signed-certificate-deployment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="docs.kcp.io" class="md-header__button md-logo" aria-label="docs.kcp.io" data-md-component="logo">
      
  <img src="../../../logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            docs.kcp.io
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              kcp-zheng: Multi-Region Self-Signed Certificate Deployment
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kcp-dev/kcp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kcp-dev/kcp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../concepts/" class="md-tabs__link">
          
  
    
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../developers/" class="md-tabs__link">
          
  
    
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contributing/" class="md-tabs__link">
          
  
    
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/" class="md-tabs__link">
          
  
    
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="docs.kcp.io" class="md-nav__button md-logo" aria-label="docs.kcp.io" data-md-component="logo">
      
  <img src="../../../logo.svg" alt="logo">

    </a>
    docs.kcp.io
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kcp-dev/kcp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kcp-dev/kcp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GOALS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Goals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Setup
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation with Helm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubectl-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kubectl Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Production Deployment
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Production Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kcp-dekker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp-dekker: Self-Signed Certificate Deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kcp-vespucci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp-vespucci: External Certificate Deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kcp-comer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp-comer: Dual Front-Proxy with Edge re-encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terminology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/quickstart-tenancy-and-apis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart: Tenancy and APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/workspaces/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Workspaces
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Workspaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/workspaces/workspace-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/workspaces/virtual-workspaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Workspaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/workspaces/workspace-initialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace Initialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/workspaces/workspace-termination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace Termination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/workspaces/mounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace Mounts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/apis/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    APIs
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/apis/admission-webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admission Webhooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/apis/built-in/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Built-in APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/apis/cached-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CachedResource API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/apis/exporting-apis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporting and Binding APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/apis/rest-access-patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Access Patterns
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/authentication/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Authentication
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/authentication/oidc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OIDC Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/authentication/workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Per-Workspace Authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/authorization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Authorization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/authorization/authorizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorizers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/sharding/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Sharding
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Sharding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/sharding/shards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/sharding/partitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/sharding/cache-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cache Server
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/miscellaneous/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/miscellaneous/braindump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture â€“ A Brain Dump
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../developers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Controllers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Controllers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/controllers/writing-kcp-aware-controllers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing kcp-aware Controllers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/controllers/client-go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    client-go
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/running-sharded/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running a Sharded Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/storage-to-rest-patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage to REST Patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Internals
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Internals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/internals/etcd-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/internals/using-kcp-as-a-library/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using kcp as a library
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../developers/investigations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Investigations
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Investigations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/investigations/logical-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logical Clusters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/investigations/minimal-api-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minimal API Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/investigations/self-service-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-service Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/investigations/transparent-multi-cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transparent Multi-Cluster
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../contributing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/coding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding Guidelines & Conventions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/monorepo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monorepo Structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Governance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Governance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/governance/general-technical-review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Technical Review
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/governance/security-self-assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Self-Assessment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../contributing/continuous-integration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Continuous integration
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Continuous integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/continuous-integration/inspecting-e2e-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inspecting Prometheus Metrics for e2e Runs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guides/accessing-embedded-etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Embedded etcd for Local Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guides/publishing-a-new-kcp-release/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publishing a New kcp Release
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guides/rebasing-kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rebasing Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guides/replicate-new-resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Replicating New Resources in the Cache Server
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/create_workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    create workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_bind/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp bind
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_bind_apiexport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp bind apiexport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_claims/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp claims
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_claims_get/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp claims get
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_claims_get_apibinding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp claims get apibinding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_crd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp crd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_crd_snapshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp crd snapshot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_workspace_create-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp workspace create-context
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_workspace_current/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp workspace current
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_workspace_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp workspace tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/kcp_workspace_use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kcp workspace use
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/workspace_create-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace create-context
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/workspace_current/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace current
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/workspace_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/workspace_use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace use
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CRD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            CRD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3_1" >
        
          
          <label class="md-nav__link" for="__nav_6_3_1" id="__nav_6_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    apis.kcp.io
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_1">
            <span class="md-nav__icon md-icon"></span>
            apis.kcp.io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/apis.kcp.io/apibindings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIBinding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/apis.kcp.io/apiconversions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIConversion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/apis.kcp.io/apiexportendpointslices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIExportEndpointSlice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/apis.kcp.io/apiexports/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIExport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/apis.kcp.io/apiresourceschemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIResourceSchema
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3_2" >
        
          
          <label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    core.kcp.io
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_2">
            <span class="md-nav__icon md-icon"></span>
            core.kcp.io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/core.kcp.io/logicalclusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LogicalCluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/core.kcp.io/shards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    tenancy.kcp.io
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_3">
            <span class="md-nav__icon md-icon"></span>
            tenancy.kcp.io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/tenancy.kcp.io/workspaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/tenancy.kcp.io/workspacetypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WorkspaceType
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3_4" >
        
          
          <label class="md-nav__link" for="__nav_6_3_4" id="__nav_6_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    topology.kcp.io
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_4">
            <span class="md-nav__icon md-icon"></span>
            topology.kcp.io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/topology.kcp.io/partitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/crd/topology.kcp.io/partitionsets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PartitionSet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-dns-records" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create DNS Records
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-1-deploy-root-shard-and-front-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster 1: Deploy Root Shard and Front-Proxy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster 1: Deploy Root Shard and Front-Proxy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2-create-namespace-and-certificate-issuer" class="md-nav__link">
    <span class="md-ellipsis">
      2. Create Namespace and Certificate Issuer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deploy-etcd-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      3. Deploy etcd Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-configure-kcp-system-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      4. Configure KCP System Certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-deploy-kcp-components" class="md-nav__link">
    <span class="md-ellipsis">
      5. Deploy KCP Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-verify-services" class="md-nav__link">
    <span class="md-ellipsis">
      6. Verify Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-update-dns-records-with-loadbalancer-ips" class="md-nav__link">
    <span class="md-ellipsis">
      7. Update DNS Records with LoadBalancer IPs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-create-admin-access-and-test-connectivity" class="md-nav__link">
    <span class="md-ellipsis">
      8. Create Admin Access and Test Connectivity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-create-alpha-and-beta-shard-bundles" class="md-nav__link">
    <span class="md-ellipsis">
      9. Create Alpha and Beta Shard Bundles
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-2-deploy-alpha-shard" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster 2: Deploy Alpha Shard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster 2: Deploy Alpha Shard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-install-prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      2. Install Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deploy-etcd-issuers-and-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      3. Deploy etcd Issuers and Certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-deploy-etcd-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      4. Deploy etcd Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-deploy-alpha-shard-from-bundle" class="md-nav__link">
    <span class="md-ellipsis">
      5. Deploy Alpha Shard from Bundle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-configure-dns-for-alpha-shard" class="md-nav__link">
    <span class="md-ellipsis">
      6. Configure DNS for Alpha Shard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-verify-alpha-shard-joined" class="md-nav__link">
    <span class="md-ellipsis">
      7. Verify Alpha Shard Joined
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-3-deploy-beta-shard" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster 3: Deploy Beta Shard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster 3: Deploy Beta Shard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-namespace_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-install-prerequisites_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Install Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deploy-etcd-issuers-and-certificates_1" class="md-nav__link">
    <span class="md-ellipsis">
      3. Deploy etcd Issuers and Certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-deploy-etcd-cluster_1" class="md-nav__link">
    <span class="md-ellipsis">
      4. Deploy etcd Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-deploy-beta-shard-from-bundle" class="md-nav__link">
    <span class="md-ellipsis">
      5. Deploy Beta Shard from Bundle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-configure-dns-for-beta-shard" class="md-nav__link">
    <span class="md-ellipsis">
      6. Configure DNS for Beta Shard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-verify-all-shards-joined" class="md-nav__link">
    <span class="md-ellipsis">
      7. Verify All Shards Joined
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-create-partitions" class="md-nav__link">
    <span class="md-ellipsis">
      Optional: Create Partitions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optional: Create Partitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-create-individual-partitions" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Create Individual Partitions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-use-a-partitionset" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Use a PartitionSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-workspaces-on-specific-shards" class="md-nav__link">
    <span class="md-ellipsis">
      Create Workspaces on Specific Shards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions-in-non-root-workspaces" class="md-nav__link">
    <span class="md-ellipsis">
      Partitions in Non-Root Workspaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-export-and-bind-an-api" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Export and Bind an API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitioned-apiexportendpointslices-for-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      Partitioned APIExportEndpointSlices for High Availability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-availability-testing" class="md-nav__link">
    <span class="md-ellipsis">
      High Availability Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="kcp-zheng-multi-region-self-signed-certificate-deployment">kcp-zheng: Multi-Region Self-Signed Certificate Deployment<a class="headerlink" href="#kcp-zheng-multi-region-self-signed-certificate-deployment" title="Permanent link">&para;</a></h1>
<p>The kcp-zheng deployment pattern uses self-signed certificates with an internal CA and is ideal for multi-region deployments across different clouds without shared network. In this scenario we use 3 different Kubernetes clusters for shards, with all shards accessed via external URLs and front-proxy as the only public endpoint.</p>
<p>Note: This guilde uses kcp-operators bundle feature to deploy shards from the root cluster. Ensure you have flag enabled in your kcp-operator deployment:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--feature-gates=ConfigurationBundle=true</span>
</code></pre></div>
<h2 id="architecture-overview">Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Certificate approach</strong>: All certificates are self-signed using an internal CA</li>
<li><strong>Access pattern</strong>: Only front-proxy is publicly accessible, shards have external URLs for cross-region access</li>
<li><strong>Network</strong>: 3 Kubernetes cluster deployments in different clouds without shared network</li>
<li><strong>DNS requirements</strong>: Public DNS records for front-proxy and each shard</li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Ensure all <a href="../prerequisites/">shared components</a> are installed before proceeding.</p>
<p><strong>Additional requirements for kcp-zheng:</strong>
- Public DNS domain with ability to create multiple A records
- LoadBalancer service capability for front-proxy and shard endpoints
- External network connectivity between clusters</p>
<h2 id="deployment-steps">Deployment Steps<a class="headerlink" href="#deployment-steps" title="Permanent link">&para;</a></h2>
<h3 id="1-create-dns-records">1. Create DNS Records<a class="headerlink" href="#1-create-dns-records" title="Permanent link">&para;</a></h3>
<p>Create public DNS records for all endpoints:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Required DNS records</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>api.zheng.example.io<span class="w">    </span>â†’<span class="w"> </span>Front-proxy<span class="w"> </span>LoadBalancer<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>cluster<span class="w"> </span><span class="m">1</span><span class="o">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>root.zheng.example.io<span class="w">   </span>â†’<span class="w"> </span>Root<span class="w"> </span>shard<span class="w"> </span>LoadBalancer<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>cluster<span class="w"> </span><span class="m">1</span><span class="o">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>alpha.zheng.example.io<span class="w">  </span>â†’<span class="w"> </span>Alpha<span class="w"> </span>shard<span class="w"> </span>LoadBalancer<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>cluster<span class="w"> </span><span class="m">2</span><span class="o">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>beta.zheng.example.io<span class="w">   </span>â†’<span class="w"> </span>Beta<span class="w"> </span>shard<span class="w"> </span>LoadBalancer<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>cluster<span class="w"> </span><span class="m">3</span><span class="o">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DNS records must be configured before proceeding with deployment.</p>
</div>
<hr />
<h2 id="cluster-1-deploy-root-shard-and-front-proxy">Cluster 1: Deploy Root Shard and Front-Proxy<a class="headerlink" href="#cluster-1-deploy-root-shard-and-front-proxy" title="Permanent link">&para;</a></h2>
<h3 id="2-create-namespace-and-certificate-issuer">2. Create Namespace and Certificate Issuer<a class="headerlink" href="#2-create-namespace-and-certificate-issuer" title="Permanent link">&para;</a></h3>
<p>On cluster 1, where the operator is running and root shard will be deployed:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>kcp-zheng
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/certificate-etcd-issuer.yaml
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/certificate-etcd-root.yaml
</code></pre></div>
<p><strong>Verify issuer is ready</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>issuer<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div>
<h3 id="3-deploy-etcd-cluster">3. Deploy etcd Cluster<a class="headerlink" href="#3-deploy-etcd-cluster" title="Permanent link">&para;</a></h3>
<p>Deploy etcd cluster with self-signed certificates:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/etcd-druid-root.yaml
</code></pre></div>
<p><strong>Verify etcd cluster</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">condition</span><span class="o">=</span>Ready<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>--all<span class="w"> </span>--timeout<span class="o">=</span>300s
</code></pre></div></p>
<h3 id="4-configure-kcp-system-certificates">4. Configure KCP System Certificates<a class="headerlink" href="#4-configure-kcp-system-certificates" title="Permanent link">&para;</a></h3>
<p>Set up certificates for kcp components using the internal CA:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/certificate-kcp.yaml
</code></pre></div>
<p><strong>Verify certificate issuance</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>certificate<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<p>Because we use Let's Encrypt for the front-proxy, and since kubectl needs explicit CA configuration, we need to deploy kcp components with extended CA bundle trust:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>curl<span class="w"> </span>-L<span class="w"> </span>-o<span class="w"> </span>isrgrootx1.pem<span class="w"> </span>https://letsencrypt.org/certs/isrgrootx1.pem
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>generic<span class="w"> </span>letsencrypt-ca<span class="w"> </span>--from-file<span class="o">=</span>tls.crt<span class="o">=</span>isrgrootx1.pem<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div>
<h3 id="5-deploy-kcp-components">5. Deploy KCP Components<a class="headerlink" href="#5-deploy-kcp-components" title="Permanent link">&para;</a></h3>
<p>Deploy kcp components:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># NOTE: These files need to be customized with your domain name before applying</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/kcp-root-shard.yaml
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/kcp-front-proxy.yaml
</code></pre></div>
<p><strong>Verify deployment</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<h3 id="6-verify-services">6. Verify Services<a class="headerlink" href="#6-verify-services" title="Permanent link">&para;</a></h3>
<p>Ensure the front-proxy LoadBalancer is provisioned:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>-o<span class="w"> </span>wide
</code></pre></div>
<p><strong>Expected services</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>NAME                     TYPE           EXTERNAL-IP     PORT(S)          AGE
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>frontproxy-front-proxy   LoadBalancer   203.0.113.10    6443:30001/TCP   5m
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>root-kcp                 LoadBalancer   203.0.113.11    6443:30002/TCP   5m
</code></pre></div></p>
<h3 id="7-update-dns-records-with-loadbalancer-ips">7. Update DNS Records with LoadBalancer IPs<a class="headerlink" href="#7-update-dns-records-with-loadbalancer-ips" title="Permanent link">&para;</a></h3>
<p>Update your DNS records with the LoadBalancer IP addresses:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>frontproxy-front-proxy<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer}&#39;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>root-kcp<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer}&#39;</span>
</code></pre></div>
<p><strong>Verify DNS propagation</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>nslookup<span class="w"> </span>api.zheng.example.com
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>nslookup<span class="w"> </span>root.zheng.example.com
</code></pre></div></p>
<p>Verify the front-proxy is accessible:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>curl<span class="w"> </span>-k<span class="w"> </span>https://api.zheng.example.com:6443/healthz
</code></pre></div></p>
<h3 id="8-create-admin-access-and-test-connectivity">8. Create Admin Access and Test Connectivity<a class="headerlink" href="#8-create-admin-access-and-test-connectivity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/kubeconfig-kcp-admin.yaml
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>kubectl<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>kcp-admin-frontproxy<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.data.kubeconfig}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>&gt;<span class="w"> </span>kcp-admin-kubeconfig-zheng.yaml
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>kcp-admin-kubeconfig-zheng.yaml<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>shards
</code></pre></div>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>NAME   REGION   URL                                    EXTERNAL URL                          AGE
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>root            https://root.zheng.example.io:6443    https://api.zheng.example.io:6443     3m20s
</code></pre></div></p>
<h3 id="9-create-alpha-and-beta-shard-bundles">9. Create Alpha and Beta Shard Bundles<a class="headerlink" href="#9-create-alpha-and-beta-shard-bundles" title="Permanent link">&para;</a></h3>
<p>Now configure the root cluster to generate alpha and beta shard bundles:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/kcp-alpha-shard.yaml
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/kcp-beta-shard.yaml
</code></pre></div>
<p><strong>Verify bundles are created</strong> (shards should NOT be running yet):
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>deployments.apps<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>NAME                     READY   UP-TO-DATE   AVAILABLE   AGE
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>alpha-shard-kcp          0/0     0            0           2m
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>beta-shard-kcp           0/0     0            0           2m
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>frontproxy-front-proxy   2/2     2            2           31m
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>root-kcp                 2/2     2            2           31m
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>root-proxy               2/2     2            2           31m
</code></pre></div></p>
<p><strong>Verify bundles are ready</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>bundles.operator.kcp.io<span class="w"> </span>-A
</code></pre></div></p>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>NAMESPACE   NAME           TARGET   PHASE   AGE
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>kcp-zheng   alpha-bundle            Ready   2m
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>kcp-zheng   beta-bundle             Ready   2m
</code></pre></div></p>
<hr />
<h2 id="cluster-2-deploy-alpha-shard">Cluster 2: Deploy Alpha Shard<a class="headerlink" href="#cluster-2-deploy-alpha-shard" title="Permanent link">&para;</a></h2>
<p>Now move to cluster 2 and deploy the alpha shard using the generated bundle.</p>
<h3 id="1-create-namespace">1. Create Namespace<a class="headerlink" href="#1-create-namespace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>kcp-zheng
</code></pre></div>
<h3 id="2-install-prerequisites">2. Install Prerequisites<a class="headerlink" href="#2-install-prerequisites" title="Permanent link">&para;</a></h3>
<p>Install etcd operator:
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>helm<span class="w"> </span>install<span class="w"> </span>etcd-druid<span class="w"> </span>oci://europe-docker.pkg.dev/gardener-project/releases/charts/gardener/etcd-druid<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span>--namespace<span class="w"> </span>etcd-druid<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">  </span>--create-namespace<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">  </span>--version<span class="w"> </span>v0.33.0
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/etcdcopybackupstasks.druid.gardener.cloud.yaml
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/etcds.druid.gardener.cloud.yaml
</code></pre></div></p>
<p>Install cert-manager if not already installed:
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>jetstack<span class="w"> </span>https://charts.jetstack.io
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>helm<span class="w"> </span>repo<span class="w"> </span>update
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>helm<span class="w"> </span>upgrade<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span>--install<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">  </span>--namespace<span class="w"> </span>cert-manager<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">  </span>--create-namespace<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">  </span>--version<span class="w"> </span>v1.18.2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">  </span>--set<span class="w"> </span>crds.enabled<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">  </span>--atomic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">  </span>cert-manager<span class="w"> </span>jetstack/cert-manager
</code></pre></div></p>
<h3 id="3-deploy-etcd-issuers-and-certificates">3. Deploy etcd Issuers and Certificates<a class="headerlink" href="#3-deploy-etcd-issuers-and-certificates" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/certificate-etcd-issuer.yaml
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/certificate-etcd-alpha.yaml
</code></pre></div>
<h3 id="4-deploy-etcd-cluster">4. Deploy etcd Cluster<a class="headerlink" href="#4-deploy-etcd-cluster" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/etcd-druid-alpha.yaml
</code></pre></div>
<p><strong>Verify etcd cluster</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">condition</span><span class="o">=</span>Ready<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>--all<span class="w"> </span>--timeout<span class="o">=</span>300s
</code></pre></div></p>
<h3 id="5-deploy-alpha-shard-from-bundle">5. Deploy Alpha Shard from Bundle<a class="headerlink" href="#5-deploy-alpha-shard-from-bundle" title="Permanent link">&para;</a></h3>
<p>Once etcd is ready, deploy the alpha shard using the generated bundle from cluster 1.</p>
<p>On cluster 1, export the alpha bundle secret:
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>alpha-bundle<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span>alpha-bundle.yaml
</code></pre></div></p>
<p>Copy the <code>alpha-bundle.yaml</code> file to cluster 2 and apply it:
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>alpha-bundle.yaml
</code></pre></div></p>
<p>Deploy resources from the bundle secret:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>../kcp-operator/_build/bundler<span class="w"> </span>--bundle-name<span class="w"> </span>alpha-bundle<span class="w"> </span>--bundle-namespace<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<p><strong>Verify shard is running</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>NAME                               READY   STATUS    RESTARTS   AGE
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>alpha-0                            2/2     Running   0          9m
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>alpha-1                            2/2     Running   0          9m
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>alpha-2                            2/2     Running   0          9m
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>alpha-shard-kcp-69db8985bf-hllmw   1/1     Running   0          90s
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>alpha-shard-kcp-69db8985bf-qzftr   1/1     Running   0          90s
</code></pre></div></p>
<h3 id="6-configure-dns-for-alpha-shard">6. Configure DNS for Alpha Shard<a class="headerlink" href="#6-configure-dns-for-alpha-shard" title="Permanent link">&para;</a></h3>
<p>Get the LoadBalancer IP:
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>alpha-shard-kcp
</code></pre></div></p>
<p>Add DNS record <code>alpha.zheng.example.io</code> pointing to the shard LoadBalancer IP.</p>
<p><strong>Verify DNS propagation</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>nslookup<span class="w"> </span>alpha.zheng.example.com
</code></pre></div></p>
<h3 id="7-verify-alpha-shard-joined">7. Verify Alpha Shard Joined<a class="headerlink" href="#7-verify-alpha-shard-joined" title="Permanent link">&para;</a></h3>
<p>From any machine with the admin kubeconfig:
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>kcp-admin-kubeconfig-zheng.yaml<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>shards
</code></pre></div></p>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>NAME    REGION   URL                                     EXTERNAL URL                          AGE
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>alpha            https://alpha.zheng.example.io:6443    https://api.zheng.example.io:6443     2m
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>root             https://root.zheng.example.io:6443     https://api.zheng.example.io:6443     38m
</code></pre></div></p>
<hr />
<h2 id="cluster-3-deploy-beta-shard">Cluster 3: Deploy Beta Shard<a class="headerlink" href="#cluster-3-deploy-beta-shard" title="Permanent link">&para;</a></h2>
<p>Repeat the same steps as cluster 2 for the beta shard.</p>
<h3 id="1-create-namespace_1">1. Create Namespace<a class="headerlink" href="#1-create-namespace_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>kcp-zheng
</code></pre></div>
<h3 id="2-install-prerequisites_1">2. Install Prerequisites<a class="headerlink" href="#2-install-prerequisites_1" title="Permanent link">&para;</a></h3>
<p>Install etcd operator:
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>helm<span class="w"> </span>install<span class="w"> </span>etcd-druid<span class="w"> </span>oci://europe-docker.pkg.dev/gardener-project/releases/charts/gardener/etcd-druid<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">  </span>--namespace<span class="w"> </span>etcd-druid<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">  </span>--create-namespace<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">  </span>--version<span class="w"> </span>v0.33.0
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/etcdcopybackupstasks.druid.gardener.cloud.yaml
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/etcds.druid.gardener.cloud.yaml
</code></pre></div></p>
<p>Install cert-manager if not already installed:
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>jetstack<span class="w"> </span>https://charts.jetstack.io
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>helm<span class="w"> </span>repo<span class="w"> </span>update
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>helm<span class="w"> </span>upgrade<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">  </span>--install<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">  </span>--namespace<span class="w"> </span>cert-manager<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">  </span>--create-namespace<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">  </span>--version<span class="w"> </span>v1.18.2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">  </span>--set<span class="w"> </span>crds.enabled<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="w">  </span>--atomic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w">  </span>cert-manager<span class="w"> </span>jetstack/cert-manager
</code></pre></div></p>
<h3 id="3-deploy-etcd-issuers-and-certificates_1">3. Deploy etcd Issuers and Certificates<a class="headerlink" href="#3-deploy-etcd-issuers-and-certificates_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/etcd-druid/certificate-etcd-issuer.yaml
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/certificate-etcd-beta.yaml
</code></pre></div>
<h3 id="4-deploy-etcd-cluster_1">4. Deploy etcd Cluster<a class="headerlink" href="#4-deploy-etcd-cluster_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>contrib/production/kcp-zheng/etcd-druid-beta.yaml
</code></pre></div>
<p><strong>Verify etcd cluster</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">condition</span><span class="o">=</span>Ready<span class="w"> </span>etcd<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>--all<span class="w"> </span>--timeout<span class="o">=</span>300s
</code></pre></div></p>
<h3 id="5-deploy-beta-shard-from-bundle">5. Deploy Beta Shard from Bundle<a class="headerlink" href="#5-deploy-beta-shard-from-bundle" title="Permanent link">&para;</a></h3>
<p>On cluster 1, export the beta bundle secret:
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>beta-bundle<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span>beta-bundle.yaml
</code></pre></div></p>
<p>Copy the <code>beta-bundle.yaml</code> file to cluster 3 and apply it:
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>beta-bundle.yaml
</code></pre></div></p>
<p>Deploy resources from the bundle secret:
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>../kcp-operator/_build/bundler<span class="w"> </span>--bundle-name<span class="w"> </span>beta-bundle<span class="w"> </span>--bundle-namespace<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<p><strong>Verify shard is running</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kcp-zheng
</code></pre></div></p>
<h3 id="6-configure-dns-for-beta-shard">6. Configure DNS for Beta Shard<a class="headerlink" href="#6-configure-dns-for-beta-shard" title="Permanent link">&para;</a></h3>
<p>Get the LoadBalancer IP:
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>beta-shard-kcp
</code></pre></div></p>
<p>Add DNS record <code>beta.zheng.example.io</code> pointing to the shard LoadBalancer IP.</p>
<p><strong>Verify DNS propagation</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>nslookup<span class="w"> </span>beta.zheng.example.io
</code></pre></div></p>
<h3 id="7-verify-all-shards-joined">7. Verify All Shards Joined<a class="headerlink" href="#7-verify-all-shards-joined" title="Permanent link">&para;</a></h3>
<p>From any machine with the admin kubeconfig:
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>kcp-admin-kubeconfig-zheng.yaml<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>shards
</code></pre></div></p>
<p><strong>Expected output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>NAME    REGION   URL                                     EXTERNAL URL                          AGE
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>alpha            https://alpha.zheng.example.io:6443    https://api.zheng.example.io:6443     15m
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>beta             https://beta.zheng.example.io:6443     https://api.zheng.example.io:6443     2m
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>root             https://root.zheng.example.io:6443     https://api.zheng.example.io:6443     50m
</code></pre></div></p>
<h3 id="optional-create-partitions">Optional: Create Partitions<a class="headerlink" href="#optional-create-partitions" title="Permanent link">&para;</a></h3>
<p>Partitions allow you to group shards for topology-aware workload placement. This is useful for geo-distributed deployments where you want to control which shards handle specific workloads.</p>
<h4 id="option-1-create-individual-partitions">Option 1: Create Individual Partitions<a class="headerlink" href="#option-1-create-individual-partitions" title="Permanent link">&para;</a></h4>
<p>Create a partition for each shard:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="s">kind: Partition</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="s">metadata:</span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="s">  name: root</span>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="s">spec:</span>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="s">  selector:</span>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="s">    matchLabels:</span>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="s">      name: root</span>
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="s">---</span>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="s">kind: Partition</span>
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="s">metadata:</span>
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="s">  name: alpha</span>
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="s">spec:</span>
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="s">  selector:</span>
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="s">    matchLabels:</span>
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="s">      name: alpha</span>
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="s">---</span>
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="s">kind: Partition</span>
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a><span class="s">metadata:</span>
<a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a><span class="s">  name: beta</span>
<a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a><span class="s">spec:</span>
<a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a><span class="s">  selector:</span>
<a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a><span class="s">    matchLabels:</span>
<a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a><span class="s">      name: beta</span>
<a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a><span class="s">EOF</span>
</code></pre></div>
<h4 id="option-2-use-a-partitionset">Option 2: Use a PartitionSet<a class="headerlink" href="#option-2-use-a-partitionset" title="Permanent link">&para;</a></h4>
<p>Alternatively, use a <code>PartitionSet</code> to automatically create partitions based on shard labels:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="s">kind: PartitionSet</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="s">metadata:</span>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="s">  name: cloud-regions</span>
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="s">spec:</span>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="s">  dimensions:</span>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="s">  - name</span>
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="s">  shardSelector:</span>
<a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a><span class="s">    matchExpressions:</span>
<a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a><span class="s">    - key: name</span>
<a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="s">      operator: In</span>
<a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="s">      values:</span>
<a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="s">      - root</span>
<a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a><span class="s">      - alpha</span>
<a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="s">      - beta</span>
<a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="s">EOF</span>
</code></pre></div>
<p>Verify the partitions were created:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>partitions
</code></pre></div>
<p><strong>Expected output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>NAME                        OWNER           AGE
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>alpha                                       6m
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>beta                                        6m
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>cloud-regions-alpha-hcfcx   cloud-regions   6s
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>cloud-regions-beta-78xkz    cloud-regions   6s
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>cloud-regions-root-4vrlm    cloud-regions   6s
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>root                                        6m
</code></pre></div></p>
<h4 id="create-workspaces-on-specific-shards">Create Workspaces on Specific Shards<a class="headerlink" href="#create-workspaces-on-specific-shards" title="Permanent link">&para;</a></h4>
<p>Create workspaces targeting specific shards using the <code>--location-selector</code> flag:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>provider<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>root
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>consumer-alpha-1<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>alpha
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>consumer-alpha-2<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>alpha
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>consumer-beta-1<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>beta
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>consumer-beta-2<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>beta
</code></pre></div>
<h4 id="partitions-in-non-root-workspaces">Partitions in Non-Root Workspaces<a class="headerlink" href="#partitions-in-non-root-workspaces" title="Permanent link">&para;</a></h4>
<p>Partitions can also be created outside of the root workspace. For example, in the provider workspace:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>provider
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="s">kind: PartitionSet</span>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="s">metadata:</span>
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="s">  name: cloud-regions</span>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="s">spec:</span>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="s">  dimensions:</span>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="s">  - name</span>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="s">  shardSelector:</span>
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="s">    matchExpressions:</span>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="s">    - key: name</span>
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="s">      operator: In</span>
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a><span class="s">      values:</span>
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a><span class="s">      - alpha</span>
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a><span class="s">EOF</span>
</code></pre></div>
<h4 id="example-export-and-bind-an-api">Example: Export and Bind an API<a class="headerlink" href="#example-export-and-bind-an-api" title="Permanent link">&para;</a></h4>
<p>Create an APIExport in the provider workspace:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>provider
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>config/examples/cowboys/apiresourceschema.yaml
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>config/examples/cowboys/apiexport.yaml
</code></pre></div>
<p>Create bindings in the consumer workspaces:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-alpha-1
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>kubectl<span class="w"> </span>kcp<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>apiexport<span class="w"> </span>root:provider:cowboys<span class="w"> </span>--name<span class="w"> </span>cowboys
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-alpha-2
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>kubectl<span class="w"> </span>kcp<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>apiexport<span class="w"> </span>root:provider:cowboys<span class="w"> </span>--name<span class="w"> </span>cowboys
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-beta-1
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>kubectl<span class="w"> </span>kcp<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>apiexport<span class="w"> </span>root:provider:cowboys<span class="w"> </span>--name<span class="w"> </span>cowboys
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a>
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-beta-2
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>kubectl<span class="w"> </span>kcp<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>apiexport<span class="w"> </span>root:provider:cowboys<span class="w"> </span>--name<span class="w"> </span>cowboys
</code></pre></div>
<h4 id="partitioned-apiexportendpointslices-for-high-availability">Partitioned APIExportEndpointSlices for High Availability<a class="headerlink" href="#partitioned-apiexportendpointslices-for-high-availability" title="Permanent link">&para;</a></h4>
<p>Create dedicated child workspaces on each shard to host shard-local APIExportEndpointSlices:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:provider
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>alpha<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>alpha
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>create<span class="w"> </span>beta<span class="w"> </span>--location-selector<span class="w"> </span><span class="nv">name</span><span class="o">=</span>beta
</code></pre></div>
<p>Inside each workspace, create a partition and APIExportEndpointSlice targeting that shard:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Partitions must be co-located in the same workspace as the APIExportEndpointSlice.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="c1"># Setup alpha shard endpoint</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:provider:alpha
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="s">kind: Partition</span>
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="s">metadata:</span>
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="s">  name: alpha</span>
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="s">spec:</span>
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="s">  selector:</span>
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="s">    matchLabels:</span>
<a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="s">      name: alpha</span>
<a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="s">---</span>
<a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a><span class="s">apiVersion: apis.kcp.io/v1alpha1</span>
<a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="s">kind: APIExportEndpointSlice</span>
<a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="s">metadata:</span>
<a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a><span class="s">  name: cowboys-alpha</span>
<a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a><span class="s">spec:</span>
<a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a><span class="s">  export:</span>
<a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="s">    name: cowboys</span>
<a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a><span class="s">    path: root:provider</span>
<a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a><span class="s">  partition: alpha</span>
<a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a><span class="s">EOF</span>
<a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a>
<a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a><span class="c1"># Setup beta shard endpoint</span>
<a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:provider:beta
<a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a><span class="s">apiVersion: topology.kcp.io/v1alpha1</span>
<a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a><span class="s">kind: Partition</span>
<a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a><span class="s">metadata:</span>
<a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a><span class="s">  name: beta</span>
<a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a><span class="s">spec:</span>
<a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a><span class="s">  selector:</span>
<a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a><span class="s">    matchLabels:</span>
<a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a><span class="s">      name: beta</span>
<a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a><span class="s">---</span>
<a id="__codelineno-61-36" name="__codelineno-61-36" href="#__codelineno-61-36"></a><span class="s">apiVersion: apis.kcp.io/v1alpha1</span>
<a id="__codelineno-61-37" name="__codelineno-61-37" href="#__codelineno-61-37"></a><span class="s">kind: APIExportEndpointSlice</span>
<a id="__codelineno-61-38" name="__codelineno-61-38" href="#__codelineno-61-38"></a><span class="s">metadata:</span>
<a id="__codelineno-61-39" name="__codelineno-61-39" href="#__codelineno-61-39"></a><span class="s">  name: cowboys-beta</span>
<a id="__codelineno-61-40" name="__codelineno-61-40" href="#__codelineno-61-40"></a><span class="s">spec:</span>
<a id="__codelineno-61-41" name="__codelineno-61-41" href="#__codelineno-61-41"></a><span class="s">  export:</span>
<a id="__codelineno-61-42" name="__codelineno-61-42" href="#__codelineno-61-42"></a><span class="s">    name: cowboys</span>
<a id="__codelineno-61-43" name="__codelineno-61-43" href="#__codelineno-61-43"></a><span class="s">    path: root:provider</span>
<a id="__codelineno-61-44" name="__codelineno-61-44" href="#__codelineno-61-44"></a><span class="s">  partition: beta</span>
<a id="__codelineno-61-45" name="__codelineno-61-45" href="#__codelineno-61-45"></a><span class="s">EOF</span>
</code></pre></div>
<p>The resulting workspace structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>root
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>â”œâ”€â”€ consumer-alpha-1
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>â”œâ”€â”€ consumer-alpha-2
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>â”œâ”€â”€ consumer-beta-1
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>â”œâ”€â”€ consumer-beta-2
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>â””â”€â”€ provider     (contains APIExport to be used by alpha, beta)
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>    â”œâ”€â”€ alpha    (contains Partition + APIExportEndpointSlice for alpha shard)
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>    â””â”€â”€ beta     (contains Partition + APIExportEndpointSlice for beta shard)
</code></pre></div>
<p>The <code>provider</code> workspace is on the root shard, while <code>provider:alpha</code> and <code>provider:beta</code> are on their respective shards.</p>
<h4 id="high-availability-testing">High Availability Testing<a class="headerlink" href="#high-availability-testing" title="Permanent link">&para;</a></h4>
<p>Create test resources in the consumer workspaces:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-alpha-1
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>config/examples/cowboys/cowboy.yaml
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:consumer-beta-1
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>config/examples/cowboys/cowboy.yaml
</code></pre></div>
<p><strong>Simulate root shard failure</strong> by scaling down the root shard deployment:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="c1"># On cluster 1</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>kubectl<span class="w"> </span>scale<span class="w"> </span>deployment<span class="w"> </span>root-kcp<span class="w"> </span>-n<span class="w"> </span>kcp-zheng<span class="w"> </span>--replicas<span class="o">=</span><span class="m">0</span>
</code></pre></div>
<p><strong>Verify behavior during root shard outage:</strong></p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>kubectl ws use :root</code></td>
<td>Timeout (root shard unavailable)</td>
</tr>
<tr>
<td><code>kubectl ws use :root:consumer-alpha-1</code></td>
<td>Works (alpha shard)</td>
</tr>
<tr>
<td><code>kubectl ws use :root:consumer-alpha-2</code></td>
<td>Works (alpha shard)</td>
</tr>
<tr>
<td><code>kubectl ws use :root:provider</code></td>
<td>Timeout (root shard unavailable)</td>
</tr>
<tr>
<td><code>kubectl ws use :root:provider:alpha</code></td>
<td>Works (alpha shard)</td>
</tr>
</tbody>
</table>
<p><strong>Access the virtual API endpoint directly:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="c1"># Get the endpoint URL from the APIExportEndpointSlice</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>use<span class="w"> </span>:root:provider:alpha
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>kubectl<span class="w"> </span>get<span class="w"> </span>apiexportendpointslice<span class="w"> </span>cowboys-alpha<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.endpoints[0].url}&#39;</span>
</code></pre></div>
<p><strong>Expected output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>https://alpha.zheng.example.io:6443/services/apiexport/&lt;identity&gt;/cowboys
</code></pre></div></p>
<p><strong>Query cowboys across all consumer workspaces on the alpha shard:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>kubectl<span class="w"> </span>-s<span class="w"> </span><span class="s1">&#39;https://alpha.zheng.example.io:6443/services/apiexport/&lt;identity&gt;/cowboys/clusters/*&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="w">  </span>get<span class="w"> </span>cowboys.wildwest.dev<span class="w"> </span>-A
</code></pre></div>
<p><strong>Expected output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>NAMESPACE   NAME
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>default     john-wayne
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>default     john-wayne
</code></pre></div></p>
<p>This demonstrates that alpha and beta shards can continue to serve API requests even when the root shard is unavailable, as long as they have their own APIExportEndpointSlices. Important part is that there must be dedicated operators running on each shard to manage these resources.</p>
<p>For more details on sharding strategies, see the <a href="../../sharding/">Sharding Overview</a>.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/kcp-dev/kcp" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://kubernetes.slack.com/archives/C021U8WSAFK" target="_blank" rel="noopener" title="kubernetes.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@kcp-dev" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.tabs", "navigation.expand", "navigation.top", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>